<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <style>
      .frankSuggestion-loading {
        display: none;
      }
      .frankSuggestion.loading .frankSuggestion-loading {
        display: block;
      }
    </style>
  </head>
  <body>
    <input type="text" />
    <script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script>
      class Suggestion {
        constructor(options) {
          this.options = options;
          this.$input = $(options.input);
          this.$input.wrap('<div class="frankSuggestion></div>"');
          this.$wrapper = this.$input.parent();
          this.$ol = $("<ol></ol>");
          this.$loading = $('<div class="frankSuggestion-loading"></div>');
          this.$loading.text(this.options.loadingTemplate);
          this.$input.after(this.$ol);
          this.bindEvents();
        }
        bindEvents() {
          let timerId;
          this.$input.on("input", (e) => {
            if (timerId) {
              window.clearTimeout(timerId);
            }
            timerId = setTimeout(() => {
              this.search(e.currentTarget.value);
              timerId = undefined;
            }, 1000);
          });
          this.$ol.on("click", "li", (e) => {
            this.$input.val($(e.currentTarget).text());
            this.$ol.empty();
          });
        }
        search(keyword) {
          this.$wrapper.addClass("loading");
          this.options.search(keyword, (array) => {
            this.$wrapper.removeClass("loading");
            this.$ol.empty();
            array.forEach((text) => {
              this.$ol.append($("<li></li>").text(text));
            });
            this.$input.after(this.$ol);
          });
        }
      }

      ////////////////////////////////////

      var s = new Suggestion({
        input: "input",
        search: function (text, callback) {
          let array = [];
          for (let i = 0; i < 5; i++) {
            var n = parseInt(Math.random() * 100, 10);
            array.push(text + n);
          }
          setTimeout(() => {
            callback(array);
          }, 2000);
        },
        loadingTemplate: "正在加载中...",
      });
    </script>
  </body>
</html>
